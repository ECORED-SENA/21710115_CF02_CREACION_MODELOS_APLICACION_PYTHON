(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["tema4"],{"0e56":function(e,a,s){e.exports=s.p+"img/4.a7b9e03a.svg"},"222c":function(e,a,s){e.exports=s.p+"img/17.91729847.png"},"294a":function(e,a,s){e.exports=s.p+"img/10.ac89d6bb.svg"},"314a":function(e,a,s){e.exports=s.p+"img/15.eb7c24b3.png"},"31b2":function(e,a,s){e.exports=s.p+"img/12.3aabeed8.png"},"3eb5":function(e,a,s){"use strict";s.r(a);var t=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"curso-main-container pb-3"},[t("BannerInterno"),t("div",{staticClass:"container tarjeta tarjeta--blanca p-4 p-md-5 mb-5"},[e._m(0),e._m(1),t("div",{staticClass:"mn p-5",staticStyle:{"background-color":"#dbefed"}},[t("div",{staticClass:"tarjeta bg-white p-5"},[t("SlyderA",{attrs:{tipo:"b"}},[t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-6 mb-lg-0 mb-3"},[t("h4",{staticStyle:{color:"#8054F8"}},[e._v("Paso 1 Separación de datos")]),t("p",[e._v("Se deben separar los datos en los datos entrenamiento y las clases de la siguiente manera, el "),t("em",[e._v("dataframe")]),e._v(" mensaje corresponde a las instancias y atributos, mientras que las etiquetas a las clases."),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v(" mensaje = pd.DataFrame(df['mensaje'])"),t("br"),e._v("etiquetas = pd.DataFrame(df['salida'])"),t("br"),t("br"),e._v("print(mensaje.head())"),t("br"),e._v("print(etiquetas.head())")]),t("br"),t("br"),e._v("El resultado es un "),t("em",[e._v("dataframe")]),e._v(" independiente en el que se dividen los datos de aprendizaje de las clases, como se observa en la imagen.")])]),t("div",{staticClass:"col-lg-6"},[t("img",{staticClass:"mb-4",attrs:{src:s("60f2"),alt:"Captura de pantalla en la que se muestra el resultado de un dataframe independiente."}}),t("p",[e._v("Separación de los datos")])])]),t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-6 mb-lg-0 mb-3"},[t("h4",{staticStyle:{color:"#8054F8"}},[e._v("Paso 2 Conversión de palabras a vectores")]),t("p",[e._v("Lo que se quiere con este procedimiento es realizar el recuento de los "),t("em",[e._v("tokens")]),e._v(" o palabras que se obtienen de los mensajes de correo electrónico, el objetivo es crear una matriz que realice un recuento por cada una de las palabras y las construya como un atributo. Para obtener este resultado debe ejecutar los siguientes comandos."),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("from sklearn.feature_extraction.text import TfidfVectorizer"),t("br"),e._v("vectorizer = TfidfVectorizer() vector = vectorizer.fit_transform(df['mensaje']) vector.shape")]),t("br"),t("br"),e._v("El resultado que se obtiene lo puede observa en la imagen.")])]),t("div",{staticClass:"col-lg-6"},[t("img",{staticClass:"mb-4",attrs:{src:s("8cc5"),alt:"Captura de pantalla en la que se muestra el resultado de un dataframe independiente."}}),t("p",[e._v("Convertir cantidades de palabras.")])])]),t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-6 mb-lg-0 mb-3"},[t("h4",{staticStyle:{color:"#8054F8"}},[e._v("Paso 3 Objetivo encontrado")]),t("p",[e._v("Ya se ha logrado cuantificar cada una de las palabras del texto de tal manera que estos serán los datos con los que entrenaremos el modelo. Lo que resta es almacenar esta variable a una que servirá para el siguiente paso del entrenamiento, para el ejemplo la denominaremos "),t("B",[e._v("instancias.")])],1)]),t("div",{staticClass:"col-lg-6"},[t("img",{staticClass:"mb-4",attrs:{src:s("0e56"),alt:"Captura de pantalla en la que se muestra el resultado de un dataframe independiente."}})])])])],1)]),t("Separador"),e._m(2),t("p",[e._v("Se puede decir que se tiene la base para empezar a realizar el entrenamiento de los datos, toda vez que ya se sabe cuáles son los datos de entrada y las clases, y ambas se encuentran en valores numéricos tal como se requiere. En el siguiente recurso se dan a conocer algunas recomendaciones importantes para realizar el entrenamiento:")]),e._m(3),t("p",{staticClass:"mb-5",attrs:{"data-aos":"fade-right"}},[e._v("Para realizar el entrenamiento seguir cada uno de los siguientes pasos:")]),e._m(4),t("p",[e._v("Todos estos pasos se ven unificados de la siguiente manera:")]),e._m(5),e._m(6),e._m(7),t("Separacion"),e._m(8),e._m(9),e._m(10),t("Separador"),e._m(11),e._m(12),e._m(13),t("Separador"),e._m(14),e._m(15),e._m(16),t("p",{staticClass:"mb-5",attrs:{"data-aos":"fade-right"}},[e._v("Se ha llegado al final de este espacio de formación en el que se ha diseñado un modelo de aprendizaje supervisado utilizando dos algoritmos de clasificación, Naive Bayes y el de regresión logística, aunque los dos dieron muy buenos resultados, el que más precisión obtuvo fue el modelo en el cual se utilizó Naive Bayes, con un 98 por ciento de aciertos, lo que lo convierte en un algoritmo ideal para este tipo de problemas donde las variables de salida son de tipo binario.")])],1)],1)},r=[function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"titulo-principal color-acento-contenido"},[s("div",{staticClass:"titulo-principal__numero"},[s("span",[e._v("4")])]),s("h1",[e._v("Crear el modelo")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-8 mb-lg-0 mb-3",attrs:{"data-aos":"fade-right"}},[t("p",[e._v("Después de la exploración y el preprocesamiento, se continúa con la construcción del modelo, como se puede ver, la variable con la que aprenderá el modelo se basa en texto que ya se ha dividido en palabras y que se debe empezar a cuantificar para poder pasar la información para que el modelo lo pueda entender."),t("br"),t("br"),e._v("Como se han venido desarrollando todas las unidades se realizará una serie de pasos que permitan en este caso la construcción de un modelo, para conocerlos revise con atención el recurso propuesto:")])]),t("div",{staticClass:"col-lg-4 col-6"},[t("img",{attrs:{src:s("a73e"),alt:""}})])])},function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"titulo-segundo color-acento-contenido",attrs:{id:"t_4_1","data-aos":"fade-right"}},[s("h2",[e._v("4.1 Entrenamiento")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-3 mb-lg-0 mb-3"},[t("div",{staticClass:"tarjeta-icono p-4 h-100"},[t("div",{staticClass:"contenido"},[t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-5 col-3"},[t("img",{attrs:{src:s("84ad"),alt:""}})])]),t("h5",[e._v("Selección de datos")]),t("p",[e._v("Seleccionar los datos de manera aleatoria. No se deben escoger datos que sean continuos o de manera organizada. ")])])])]),t("div",{staticClass:"col-lg-3 mb-lg-0 mb-3"},[t("div",{staticClass:"tarjeta-icono p-4 h-100"},[t("div",{staticClass:"contenido"},[t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-5 col-3"},[t("img",{attrs:{src:s("b29d"),alt:""}})])]),t("h5",[e._v("Separar los datos")]),t("p",[e._v("Reserve una muestra que por lo general equivale al veinte por ciento de los datos, los cuales debe asegurarse que no se utilizaron en el aprendizaje.")])])])]),t("div",{staticClass:"col-lg-3 mb-lg-0 mb-3"},[t("div",{staticClass:"tarjeta-icono p-4 h-100"},[t("div",{staticClass:"contenido"},[t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-5 col-3"},[t("img",{attrs:{src:s("8d74"),alt:""}})])]),t("h5",[e._v(" Entrenar los datos")]),t("p",[e._v("Seleccione el ochenta por ciento de los datos para realizar el entrenamiento de los datos.")])])])]),t("div",{staticClass:"col-lg-3 mb-lg-0 mb-3"},[t("div",{staticClass:"tarjeta-icono p-4 h-100"},[t("div",{staticClass:"contenido"},[t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-5 col-3"},[t("img",{attrs:{src:s("c1f4"),alt:""}})])]),t("h5",[e._v("Selección de algoritmo")]),t("p",[e._v("De acuerdo con el requerimiento, seleccione el algoritmo o algoritmos de clasificaciones que mejor le vayan dependiendo del tipo de problema a resolver.")])])])])])},function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"row justify-content-center mb-5"},[s("div",{staticClass:"col-lg-10"},[s("div",{staticClass:"p-5",staticStyle:{"background-color":"#dbefed"}},[s("div",{staticClass:"titulo-pasos mb-5"},[s("h4",{staticClass:"mb-0"},[e._v("Paso 1")])]),s("p",{staticClass:"mb-5",attrs:{"data-aos":"fade-right"}},[e._v("Como primer paso se procede a seleccionar los datos de entrenamiento y de prueba, para ello haga usos de los siguientes comandos."),s("br"),s("br"),s("code",{staticClass:"codigo"},[e._v("from sklearn.model_selection import GridSearchCV,train_test_split,StratifiedKFold,cross_val_score,learning_curve"),s("br"),s("br"),e._v("X_train, X_test, y_train, y_test = train_test_split(instancias, df['salida'], test_size=0.2, random_state=131)")]),s("br"),s("br"),e._v("· "),s("b",[e._v("X_train:")]),e._v(" corresponde a los datos de entrenamiento."),s("br"),e._v("· "),s("b",[e._v("X_test:")]),e._v(" Aquí se guardan los datos que son separados para realizar las pruebas."),s("br"),e._v("· "),s("b",[e._v("y_train:")]),e._v(" etiquetas de salida correspondientes a las instancias de entrenamiento."),s("br"),e._v("· "),s("b",[e._v("y_test:")]),e._v(" etiquetas de salida que corresponde a las instancias seleccionadas de entrenamiento."),s("br"),e._v("· "),s("b",[e._v("instancias:")]),e._v(" datos preparados para el entrenamiento."),s("br"),e._v("· "),s("b",[e._v("df['salida'")]),e._v(":] etiquetas o clases de salida de la clasificación de las instancias."),s("br"),e._v("· "),s("b",[e._v("test_size:")]),e._v(" valor entre 0 y 1 que indica cuál es el porcentaje de datos de prueba que serán separados, para nuestro ejemplo será del 20 por ciento, es decir 0.2."),s("br"),e._v("· "),s("b",[e._v("random_state:")]),e._v(" este parámetro se utiliza para realizar la mezcla de los datos aleatoriamente tal como se recomienda anteriormente, el número corresponde al número brde llamados "),s("br"),s("br"),e._v("de la función y la mezcla se realiza antes de la división de los datos.")]),s("div",{staticClass:"titulo-pasos mb-5"},[s("h4",{staticClass:"mb-0"},[e._v("Paso 2")])]),s("p",[e._v("Lo que sigue es la selección del algoritmo de clasificación, en este caso se utilizará el de Naive Bayes, y Regresión Logística."),s("br"),s("br"),e._v("Se importan las librerías necesarias para poder implementarlas."),s("br"),s("code",{staticClass:"codigo"},[e._v("from sklearn.naive_bayes import MultinomialNB"),s("br"),e._v("from sklearn.linear_model import LogisticRegression")]),s("br"),s("br"),e._v("Para utilizar el algoritmo de Naive Bayes, se le asigna la configuración a la variable NB,"),s("br"),s("code",{staticClass:"codigo"},[e._v("NB = MultinomialNB(alpha=0.5)")]),s("br"),s("br"),e._v("Tener en cuenta el siguiente parámetro."),s("br"),s("code",{staticClass:"codigo"},[e._v("alpha=")]),e._v(" parámetro de suavizado de Laplace si se omite por defecto asignaría 1, para nuestro caso se establecerá en 0.5"),s("br"),s("br"),e._v("Para el algoritmo de regresión logística se utilizará esta configuración, que se almacenará en la variable RL."),s("br"),s("code",{staticClass:"codigo"},[e._v("RL = LogisticRegression(solver='liblinear', penalty='l1')")]),s("br"),s("br"),s("b",[e._v("Solver:")]),e._v(" algoritmo para utilizar en el problema de optimización. El valor predeterminado es 'lbfgs'. Para elegir un solucionador, es posible que se desee considerar los siguientes aspectos:"),s("br"),s("br"),e._v("· Para conjuntos de datos pequeños, 'liblinear' es una buena opción, mientras que 'sag' y 'saga' son más rápidos para conjuntos grandes;"),s("br"),e._v("· Para problemas multiclase, solo 'newton-cg', 'sag', 'saga' y 'lbfgs' manejan la pérdida multinomial;"),s("br"),e._v("· 'liblinear' se limita a esquemas de uno contra el resto.")]),s("div",{staticClass:"titulo-pasos mb-5"},[s("h4",{staticClass:"mb-0"},[e._v("Paso 3")])]),s("p",[e._v("Se utilizan los siguientes comandos para realizar el entrenamiento con el algoritmo de Naive Bayes usar los siguientes comandos."),s("br"),s("code",{staticClass:"codigo"},[e._v("NB.fit(X_train,y_train)")]),s("br"),s("br"),e._v("Para realizar el entrenamiento con el algoritmo de Regresión Logística, de igual manera use el mismo comando, pero con su respectiva configuración almacenada en la variable RL"),s("br"),s("code",{staticClass:"codigo"},[e._v("RL.fit(X_train,y_train)")])])])])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-3"},[t("div",{staticClass:"col-lg-10"},[t("div",{staticClass:"tarjeta color-acento-contenido p-4"},[t("div",{staticClass:"row justify-content-center align-items-center"},[t("div",{staticClass:"col-lg-2 col-6 mb-lg-0 mb-3"},[t("img",{attrs:{src:s("7915"),alt:""}})]),t("div",{staticClass:"col-lg-10"},[t("p",{staticClass:"text-white"},[e._v("Importación de las librerías:"),t("br"),t("b",[e._v("from sklearn.naive_bayes import MultinomialNB")]),t("br"),t("b",[e._v("from sklearn.linear_model import LogisticRegression")])])])])])])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-3"},[t("div",{staticClass:"col-lg-10"},[t("div",{staticClass:"tarjeta color-acento-contenido p-4"},[t("div",{staticClass:"row justify-content-center align-items-center"},[t("div",{staticClass:"col-lg-2 col-6 mb-lg-0 mb-3"},[t("img",{attrs:{src:s("294a"),alt:""}})]),t("div",{staticClass:"col-lg-10"},[t("p",{staticClass:"text-white"},[e._v("Configuración de los parámetros de los algoritmos de clasificación:"),t("br"),t("b",[e._v("NB = MultinomialNB(alpha=0.2)")]),t("br"),t("b",[e._v("RL = LogisticRegression(solver='liblinear', penalty='l1')")])])])])])])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-10"},[t("div",{staticClass:"tarjeta color-acento-contenido p-4"},[t("div",{staticClass:"row justify-content-center align-items-center"},[t("div",{staticClass:"col-lg-2 col-6 mb-lg-0 mb-3"},[t("img",{attrs:{src:s("4028"),alt:""}})]),t("div",{staticClass:"col-lg-10"},[t("p",{staticClass:"text-white"},[e._v("Entrenamiento:"),t("br"),t("b",[e._v("NB.fit(X_train,y_train)")]),t("br"),t("b",[e._v("RL.fit(X_train,y_train)")])])])])])])])},function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"titulo-segundo color-acento-contenido",attrs:{id:"t_4_2","data-aos":"fade-right"}},[s("h2",[e._v("4.2 Evaluación ")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center align-items-center mb-5"},[t("div",{staticClass:"col-lg-4 col-8 mb-lg-0 mb-3",attrs:{"data-aos":"fade-right"}},[t("img",{attrs:{src:s("31b2"),alt:""}})]),t("div",{staticClass:"col-lg-8"},[t("p",[e._v("En esta etapa del proceso se debe realizar la evaluación de los modelos. Una vez entrenados se debe probar qué tan eficientes han sido dichos modelos, es importante recordar que en principio se separó un conjunto de datos correspondientes al veinte por ciento, y son estos los que ayudarán a probar el modelo y ver qué tan eficiente es."),t("br"),t("br"),e._v("Para el proceso de evaluación se debe seguir algunos pasos para conocerlos, revise con atención el siguiente recurso educativo:")])])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-10"},[t("div",{staticClass:"p-5",staticStyle:{"background-color":"#dbefed"}},[t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 1")])]),t("p",{staticClass:"mb-5",attrs:{"data-aos":"fade-right"}},[e._v("Se deben importar las librerías necesarias para realizar las métricas."),t("br"),t("code",{staticClass:"codigo"},[e._v("from sklearn import metrics")])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 2")])]),t("p",[e._v("Realizar la predicción de los datos con el modelo entrenado, primero con Naive Bayes y posteriormente con regresión logística, recordemos que los modelos son NB y RL respectivamente; para realizar la predicción, utilice los datos de prueba y ejecute el siguiente comando."),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("y_pred_NB = NB.predict(X_test)")]),t("br"),t("br"),e._v("Los resultados se almacenan en y_pred_NB, y para el modelo de regresión logística realice el mismo procedimiento, pero almacenando en una variable diferente."),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("y_pred_RL = RL.predict(X_test)")])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 3")])]),t("p",[e._v("Las salidas de la predicción del modelo entrenado se deben comparar con las salidas correctas para ese conjunto de datos, y de esta manera saber el porcentaje de aciertos para cada uno de los modelos. La comparativa se realiza implementando las siguientes líneas de código."),t("br"),t("br"),e._v("Para el modelo de Naive Bayes, utilice el siguiente comando:"),t("br"),t("code",{staticClass:"codigo"},[e._v("metrics.accuracy_score(y_test, y_pred_NB)")]),t("br"),t("br"),e._v("Y el resultado que se obtiene se aprecia en la siguiente imagen.")]),t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-6"},[t("img",{attrs:{src:s("e267"),alt:"Porcentaje de aciertos para el modelo utilizando Naive Bayes"}})])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 4")])]),t("p",[e._v("De igual manera se debe comparar en el modelo de regresión logística, cuál es resultado obtenido, ejecutando el mismo comando así:")]),t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-6"},[t("img",{attrs:{src:s("5327"),alt:"Captura de pantalla en el que muestra el mdelo de regresión logística."}})])]),t("p",[e._v("Como se indicó en las recomendaciones, se dejaron los datos para las pruebas y efectivamente sirvieron para validar la efectividad del modelo, el resultado arrojado es del 98 % donde se utilizó el algoritmo de clasificación Naive Bayes, mientras que con el modelo donde se implementó regresión logística se obtuvo un porcentaje de acierto del 95 %.")])])])])},function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"titulo-segundo color-acento-contenido",attrs:{id:"t_4_3","data-aos":"fade-right"}},[s("h2",[e._v("4.3 Predicciones")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-9 mb-lg-0 mb-3",attrs:{"data-aos":"fade-right"}},[t("p",[e._v("Con los modelos evaluados se procede a realizar las predicciones, esta vez con entradas completamente nuevas. Con el aprendizaje realizado el modelo debería estar en la capacidad de clasificar los datos en correos electrónicos normales o maliciosos."),t("br"),t("br"),e._v("Es importante aclarar que los nuevos datos que le pasen al modelo deben estar relacionados con la temática bajo la cual este modelo fue entrenado, o sea con mensajes de correos electrónicos."),t("br"),t("br"),e._v("Para realizar las predicciones se tomará el modelo con mayor efectividad que arrojó la evaluación, que sería el que se entrenó con el algoritmo de clasificación Naive Bayes con un porcentaje del 98 por ciento."),t("br"),t("br"),e._v("Se establecerán múltiples entradas y para este fin se deben seguir los pasos expuestos en el recurso educativo:")])]),t("div",{staticClass:"col-lg-3 col-6"},[t("img",{attrs:{src:s("314a"),alt:""}})])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-10"},[t("div",{staticClass:"p-5",staticStyle:{"background-color":"#dbefed"}},[t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 1")])]),t("p",{staticClass:"mb-5",attrs:{"data-aos":"fade-right"}},[t("b",[e._v("Definir las entradas.")]),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("Entrada1=['free mobile now']"),t("br"),e._v("Entrada2=['Sorry Mr James']"),t("br"),e._v("Entrada3=['I need your help']"),t("br"),e._v("Entrada4=['call me text']")])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 2")])]),t("p",[t("b",[e._v("Crear una función para realizar las predicciones")]),e._v(", de la siguiente manera"),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("def clasificar(resultado):"),t("br"),e._v("if resultado == 1:"),t("br"),e._v('print ("Este es un Mensaje Malicioso")'),t("br"),e._v('else: print ("Es un Mensaje Normal")')]),t("br"),t("br"),e._v("La función espera por un resultado en caso de ser 1 lo clasifica como mensaje malicioso de lo contrario como mensaje normal.")]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 3")])]),t("p",[t("b",[e._v("Vectorizar las entradas nuevas, así:")]),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("salida=vectorizer.transform(Entrada1)")]),t("br"),t("br"),e._v("Se deben transformar los datos y dejarlos de igual manera de como se entrenaron.")]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 4")])]),t("p",[t("b",[e._v("Predecir y mostrar el resultado")]),e._v(" "),t("br"),e._v("Realizar la predicción con la salida de los datos vectorizados y evaluar el resultado con la función de clasificación. resultado = NB.predict(salida) print('Mensaje: ',Entrada1) clasificar(resultado) El resultado para la primera entrada se aprecia en la imagen")]),t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-8"},[t("img",{attrs:{src:s("d286"),alt:"Captura de pantalla en la que se evidencia la predicción de entradas."}})])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 5")])]),t("p",[t("b",[e._v("Predecir más entradas.")]),t("br"),t("br"),e._v("Realizar más pruebas para verificar la efectividad del modelo, las demás entradas de nuestro ejemplo dan como resultado la información de la imagen.")]),t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-8"},[t("img",{attrs:{src:s("222c"),alt:"Captura de pantalla en la que se evidencia la predicción de entradas."}})])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 6")])]),t("p",[e._v("Finalmente, el código completo del proceso de predicción es el siguiente.")]),t("p",[t("code",{staticClass:"codigo"},[e._v("Entrada1=['free mobile now']"),t("br"),e._v("Entrada2=['Sorry Mr James']"),t("br"),e._v("Entrada3=['I need your help']"),t("br"),e._v("Entrada4=['call me text']"),t("br"),t("br"),e._v("def clasificar(resultado):"),t("br"),e._v("if resultado == 1:"),t("br"),e._v('print ("Este es un Mensaje Malicioso")'),t("br"),e._v("else:"),t("br"),e._v('print ("Es un Mensaje Normal")'),t("br"),t("br"),e._v("salida=vectorizer.transform(Entrada1)"),t("br"),e._v("resultado = NB.predict(salida)"),t("br"),e._v("print('Mensaje 1: ',Entrada1)"),t("br"),e._v("clasificar(resultado)"),t("br"),t("br"),e._v("salida=vectorizer.transform(Entrada2)"),t("br"),e._v("resultado = NB.predict(salida)"),t("br"),e._v("print('Mensaje 2: ',Entrada2)"),t("br"),e._v("clasificar(resultado)"),t("br"),t("br"),e._v("salida=vectorizer.transform(Entrada3)"),t("br"),e._v("resultado = NB.predict(salida)"),t("br"),e._v("print('Mensaje 3: ',Entrada3)"),t("br"),e._v("clasificar(resultado)"),t("br"),t("br"),e._v("salida=vectorizer.transform(Entrada4)"),t("br"),e._v("resultado = NB.predict(salida)"),t("br"),e._v("print('Mensaje 4: ',Entrada4)")])])])])])},function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("div",{staticClass:"titulo-segundo color-acento-contenido",attrs:{id:"t_4_4","data-aos":"fade-right"}},[s("h2",[e._v("4.4 Evaluar el modelo y análisis de errores")])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-2 col-6 mb-lg-0 mb-3",attrs:{"data-aos":"fade-right"}},[t("img",{attrs:{src:s("d311"),alt:""}})]),t("div",{staticClass:"col-lg-8"},[t("p",[e._v("Finalmente, para analizar el modelo en cuanto al número de errores que se pueden presentar, ya sea porque se realiza la clasificación de correos electrónicos maliciosos como normales, o viceversa, se utilizará la técnica denominada matriz de confusión."),t("br"),t("br"),e._v("Para implementar dicha técnica se deben seguir los pasos expuestos en el recurso propuesto:")])])])},function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-10"},[t("div",{staticClass:"p-5",staticStyle:{"background-color":"#dbefed"}},[t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 1. Importar las librerías")])]),t("p",{staticClass:"mb-5",attrs:{"data-aos":"fade-right"}},[e._v("Para realizar la implementación usaremos la librería que nos ayuda con el proceso, que es la primera, y la segunda librería que nos permitirá las visualizaciones gráficas."),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("from sklearn.metrics import confusion_matrix"),t("br"),e._v("import seaborn as sns")])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 2. Realizar la predicción con las pruebas")])]),t("p",[e._v("Procedemos nuevamente a realizar las predicciones con nuestro conjunto de datos de prueba, ya que son los indicados para generar un análisis que permita determinar qué tantos errores se presentan en nuestro modelo."),t("br"),t("br"),e._v("Para realizar este procedimiento utilice las siguientes líneas de código que le permitirán calcular las predicciones con el modelo y también asignar las predicciones correctas."),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("y_pred_NB = NB.predict(X_test)"),t("br"),e._v("y_correctas_NB = y_test")]),t("br"),t("br"),e._v("Como se aprecia, la primera línea corresponde a las predicciones con el modelo entrenado usando el algoritmo Naive Bayes, pasándole como entradas los datos de prueba que fueron separados, y la segunda línea simplemente le reasignamos a una nueva variable los valores de salida correcto de los datos de prueba. ")]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 3. Analizar los errores")])]),t("p",[e._v("Con los datos de las salidas de las predicciones y las salidas correctas se aplica el método de matriz de confusión, de la siguiente manera."),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("MC = confusion_matrix(y_correctas_NB, y_pred_NB)")])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 4. Graficar resultados")])]),t("p",[e._v("Implemente las salidas de manera gráfica para entender mucho mejor los datos resultantes; para ello, utilice los siguientes comandos."),t("br"),t("br"),t("code",{staticClass:"codigo"},[e._v("f, ax = plt.subplots(figsize =(5,5))"),t("br"),e._v('sns.heatmap(MC,annot = True,linewidths=0.5,linecolor="blue",fmt = ".0f",ax=ax)'),t("br"),e._v('plt.xlabel("y_pred_NB")'),t("br"),e._v('plt.ylabel("y_correctas_NB")'),t("br"),e._v("plt.show()")])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 5. Analizar gráfico")])]),t("p",[e._v("El resultado que arroja la técnica de matriz de confusión se puede observar en la siguiente gráfica, en la cual existe un equilibrio, ya que las veces en las que predijo correos normales como "),t("b",[e._v("maliciosos")]),e._v(" es de 10, y en las que predijo correos "),t("b",[e._v("maliciosos")]),e._v(" como normales de 8.")]),t("div",{staticClass:"row justify-content-center mb-5"},[t("div",{staticClass:"col-lg-7"},[t("img",{attrs:{src:s("42ee"),alt:"Gráfico para análisis de errores."}}),t("figcaption",[e._v("Matriz de confusión ")])])]),t("div",{staticClass:"titulo-pasos mb-5"},[t("h4",{staticClass:"mb-0"},[e._v("Paso 6. Otros cálculos")])]),t("p",[e._v("Para realizar los demás cálculos utilice los siguientes comandos.")]),t("p",[t("b",[e._v("Para calcular la exhaustividad utilice:")]),t("br"),t("code",{staticClass:"codigo"},[e._v("from sklearn.metrics import recall_score "),t("br"),e._v("recall_score(y_correctas_NB, y_pred_NB, average=None) "),t("br"),e._v("Resultado: array([0.99183673, 0.92537313])")])]),t("p",[t("b",[e._v("Para Calcular la precisión utilice:")]),t("br"),t("code",{staticClass:"codigo"},[e._v("from sklearn.metrics import "),t("br"),e._v("precision_score "),t("br"),e._v("precision_score(y_correctas_NB, y_pred_NB, average=None)")])]),t("p",[t("b",[e._v("Resultado:")]),t("br"),t("code",{staticClass:"codigo"},[e._v("array([0.9898167 , 0.93939394])")])]),t("p",[t("b",[e._v("Para el cálculo de la métrica F1")]),t("br"),t("code",{staticClass:"codigo"},[e._v("from sklearn.metrics import f1_score "),t("br"),e._v("f1_score(y_correctas_NB, y_pred_NB, average=None)")])]),t("p",[t("b",[e._v("Resultado:")]),t("br"),t("code",{staticClass:"codigo"},[e._v("array([0.99082569, 0.93233083])")])])])])])}],o={name:"Tema4",data:function(){return{}},mounted:function(){var e=this;this.$nextTick((function(){e.$aosRefresh()}))},updated:function(){this.$aosRefresh()}},i=o,l=s("2877"),n=Object(l["a"])(i,t,r,!1,null,null,null);a["default"]=n.exports},4028:function(e,a,s){e.exports=s.p+"img/11.e066fc2d.svg"},"42ee":function(e,a,s){e.exports=s.p+"img/19.0ad9de29.png"},5327:function(e,a,s){e.exports=s.p+"img/14.5c7b5e56.png"},"60f2":function(e,a,s){e.exports=s.p+"img/2.4ed83a90.png"},7915:function(e,a,s){e.exports=s.p+"img/9.ac14aac4.svg"},"84ad":function(e,a,s){e.exports=s.p+"img/5.183e0512.svg"},"8cc5":function(e,a,s){e.exports=s.p+"img/3.4ed83a90.png"},"8d74":function(e,a,s){e.exports=s.p+"img/7.fc5910f5.svg"},a73e:function(e,a,s){e.exports=s.p+"img/1.ec13543f.png"},b29d:function(e,a,s){e.exports=s.p+"img/6.1452c9f2.svg"},c1f4:function(e,a,s){e.exports=s.p+"img/8.5f68b071.svg"},d286:function(e,a,s){e.exports=s.p+"img/16.6f8c6454.png"},d311:function(e,a,s){e.exports=s.p+"img/18.ec43c7f5.svg"},e267:function(e,a,s){e.exports=s.p+"img/13.ee7a5b80.png"}}]);
//# sourceMappingURL=tema4.713051cd.js.map